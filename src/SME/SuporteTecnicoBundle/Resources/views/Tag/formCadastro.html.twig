{% extends 'SuporteTecnicoBundle:Index:index.html.twig' %}

{% block headerTitle %}Suporte Técnico > Categorias > Tags{% endblock %}

{% block page %}
    <table class="table table-striped table-hover">
        <thead>
            <tr>
                <th class="text-center">Tag</th>
                <th class="text-center">Prioridade</th>
                <th class="text-center">Opções</th>
            </tr>
        </thead>
        <tbody>
            {% for tag in tags %}
                <tr>
                    <td>{{tag.nome}}</td>
                    <td class="text-center">{{tag.prioridade.nome}}</td>
                    <td class="text-center">
                        <a class="lnkExcluirTag" href="{{path('suporte_categoria_tag_excluir', { 'categoria': categoria.id, 'tag': tag.id })}}">
                            <span class="glyphicon glyphicon-remove"></span>
                        </a>
                    </td>
                </tr>
            {% else %}
                <tr> 
                    <td colspan="3" class="text-center">Nenhuma tag cadastrada</td> 
                </tr>
            {% endfor %}
        </tbody>
    </table>
    {{form_start(form, {'attr': { 'id': 'formTag' } })}}
        <div class="row">
            <div class="col-lg-6">
                {{form_label(form.nome)}}
                {{form_widget(form.nome, {'attr': {'class': 'form-control'} })}}
            </div>
            <div class="col-lg-6">
                {{form_label(form.prioridade)}}
                <div class="input-group">
                    {{form_widget(form.prioridade, {'attr': {'class': 'form-control'} })}}
                    <span class="input-group-btn">
                        {{form_widget(form.btnSalvar, {'attr': {'class': 'btn btn-primary'} })}}
                    </span>
                </div>
            </div>
        </div>   
    {{form_end(form)}}
{% endblock %}

{% block javascript %}
    {{parent()}}
    <script type="text/javascript">
        $(document).ready(function (){
            $("#{{form.btnSalvar.vars.id}}").click(function(ev) {
                $.ajax({
                    type: "POST",
                    url: "{{path('suporte_categoria_tag_cadastrar', {'categoria': categoria.id})}}",
                    data: $("#formTag").serialize(),
                    success: function(retorno) {
                        $("#divTags").html(retorno);
                    }
                });
                ev.preventDefault();
            });
            
            $(".lnkExcluirTag").click(function(ev) {
                $.ajax({
                    type: "POST",
                    url: $(this).attr("href"),
                    success: function(retorno) {
                        $("#divTags").html(retorno);
                    }
                });
                ev.preventDefault();
            });
        });
    </script>
{% endblock %}
